// FIL101 Comprehensive Study Guide Application

// Enhanced Application Data with Comprehensive Content
const appData = {
  modules: [
    {
      moduleNumber: 1,
      title: "Depinisyon ng Wika at iba't ibang Pananaw ng Wika",
      description: "Comprehensive study of language definitions and various theoretical perspectives",
      category: "Foundation",
      color: "foundation",
      learningObjectives: [
        "Mauunawaan ang iba't ibang depinisyon ng wika",
        "Makilala ang mga pangunahing teoretiko ng linggwistika",
        "Maiuugnay ang iba't ibang pananaw sa modernong pag-aaral ng wika",
        "Matataya ang kahalagahan ng bawat perspektibo"
      ],
      studyCards: [
        {
          title: "Ano ang Wika? - Pangunahing Depinisyon",
          content: "Ang wika ay isang kompleksong sistema ng komunikasyon na ginagamit ng mga tao upang magpahayag ng kanilang mga kaisipan, damdamin, at intensyon. Ito ay hindi lamang simpleng kumpol ng mga salita, kundi isang organisadong estruktura na may sariling mga patakaran sa pagbuo ng tunog (phonology), salita (morphology), pangungusap (syntax), at kahulugan (semantics).\n\nAyon kay Victoria Fromkin at Robert Rodman, ang wika ay 'isang sistema ng mga arbitraryong simbolo na ginagamit para sa komunikasyon.' Ang salitang 'arbitraryo' ay nangangahulugang walang natural na koneksyon sa pagitan ng tunog ng salita at ng bagay na tinutukoy nito. Halimbawa, ang salitang 'aso' ay walang natural na koneksyon sa hayop na aso - ito ay nagkaroon lang ng kahulugan dahil napagkasunduan ng mga Pilipino na gamitin ang tunog na ito para sa naturang hayop.\n\nAng wika ay may tatlong pangunahing katangian: una, ito ay sistematiko - may mga tiyak na patakaran sa pagbuo ng mga salita at pangungusap; pangalawa, ito ay simboliko - ang mga tunog ay kumakatawan sa mga ideya o bagay; at pangatlo, ito ay panlipunan - ginagamit ito ng mga tao upang makipag-ugnayan sa kanilang kapwa. Ang mga katangiang ito ang nagbibigay sa wika ng kapangyarihang maging pangunahing kasangkapan ng pagkakaisa at pagpapadala ng kaalaman sa loob ng isang pamayanan."
        },
        {
          title: "Pananaw ni Ferdinand de Saussure - Structuralism",
          content: "Si Ferdinand de Saussure (1857-1913) ay kilala bilang 'Ama ng Modernong Linggwistika' dahil sa kanyang revolutionary na mga ideya tungkol sa wika. Ang kanyang structuralist na pananaw ay nagbigay ng bagong direksyon sa pag-aaral ng wika noong unang bahagi ng ika-20 siglo.\n\nAng pinakasikat na kontribusyon ni Saussure ay ang konsepto ng 'linguistic sign' o palatandaan sa wika. Ayon sa kanya, ang bawat salita ay binubuo ng dalawang bahagi: ang 'signifier' (tagapagpahiwatig) - ang actual na tunog o nakasulat na anyo ng salita, at ang 'signified' (tinutukoy) - ang konsepto o ideyang naaayon sa salitang iyon. Halimbawa, sa salitang 'puno,' ang signifier ay ang mga tunog /p-u-n-o/, habang ang signified ay ang konsepto ng isang mataas na halaman na may sanga at dahon.\n\nMahalagang punto rin ni Saussure ang arbitrariness ng wika - walang natural na koneksyon sa pagitan ng signifier at signified. Walang dahilan kung bakit ang 'puno' ay tinatawag na 'puno' sa Tagalog, 'tree' sa Ingles, o '√°rbol' sa Kastila - ito ay resulta lang ng cultural convention. Isa pang mahahalagang konsepto ni Saussure ay ang pagkakaiba sa pagitan ng 'langue' (ang abstract na sistema ng wika) at 'parole' (ang aktwal na paggamit ng wika sa pangaraw-araw). Ang langue ay ang mga patakaran at estruktura ng wika na nakashared ng lahat ng nagsasalita, habang ang parole ay ang indibidwal na pagpapahayag ng bawat tao."
        },
        {
          title: "Pananaw ni Leonard Bloomfield - Behaviorist Approach",
          content: "Si Leonard Bloomfield (1887-1949) ay isa sa mga nangunguna sa American structuralism at behaviorist approach sa pag-aaral ng wika. Ang kanyang pananaw ay mabigat na naiimpluwensyahan ng behaviorist psychology ni B.F. Skinner, na naniniwala na ang pag-uugali - kabilang na ang wika - ay natututunan sa pamamagitan ng stimulus at response.\n\nSa kanyang aklat na 'Language' (1933), binigyang-diin ni Bloomfield na ang wika ay isang 'totality of utterances that can be made in a speech community.' Ang kanyang scientific approach ay naglalayong pag-aralan ang wika sa pamamagitan ng observable behavior lamang, hindi sa mga hindi nakikitang mental processes. Ito ay naging ugat ng descriptive linguistics na nagiging scientific method sa pag-aaral ng wika.\n\nAng behaviorist theory ni Bloomfield ay nagsasabing natututunan ang wika sa pamamagitan ng imitation, practice, at reinforcement. Ang mga bata ay natututong magsalita dahil ginagaya nila ang mga nakakatanda, at kapag tama ang kanilang pronunciation o grammar, nakakakuha sila ng positive feedback. Halimbawa, kapag sinabi ng bata ang 'mama' at nagkakaroon ng positive reaction ang nanay, mas malaki ang tsansang ulitin ng bata ang salitang iyon.\n\nBagama't hindi na ganoon kalakas ang impluwensya ng behaviorist approach ngayon dahil sa mga kritisismo nina Noam Chomsky, ang contributions ni Bloomfield sa descriptive linguistics at sa pag-develop ng scientific methods sa pag-aaral ng wika ay nananatiling mahalaga. Ang kanyang emphasis sa empirical observation at systematic analysis ay nagbigay ng matatag na pundasyon sa modernong linggwistika."
        },
        {
          title: "Pananaw ni Noam Chomsky - Generative Grammar at LAD",
          content: "Si Noam Chomsky ay nagdulot ng isang malaking revolution sa linggwistika noong dekada 1950 sa pamamagitan ng kanyang generative grammar theory. Ang kanyang pananaw ay direktang sumuway sa behaviorist approach ni Bloomfield at nagmungkahi ng isang cognitive approach sa pag-aaral ng wika.\n\nAng pinakarevolutionary na ideya ni Chomsky ay ang Language Acquisition Device (LAD) - ang paniniwala na ang mga tao ay ipinanganak na may innate capacity para sa wika. Ayon sa kanya, ang utak ng tao ay may special 'organ' na specifically designed para sa pag-acquire ng wika. Ito ay nagpapaliwanag kung bakit ang lahat ng normal na mga bata ay nakakapag-acquire ng kahit na anong wika nang hindi nahihirapan, kahit na complex ang grammar ng wikang iyon.\n\nAng Universal Grammar (UG) ni Chomsky ay nagsasabing may mga fundamental principles ng grammar na shared ng lahat ng human languages. Ito ay hindi nangangahulugang lahat ng wika ay pareho, kundi na may mga basic structural principles na common sa lahat. Halimbawa, lahat ng wika ay may subject at predicate, lahat ay may paraan ng pagtatanong, lahat ay may negation, atbp.\n\nAng generative approach ni Chomsky ay nag-focus sa competence (ang unconscious knowledge ng native speaker) kaysa sa performance (ang actual use ng wika). Ayon sa kanya, ang goal ng linguistics ay i-describe ang mental grammar ng native speaker - ang mga unconscious rules na gumagamit natin sa pag-form ng mga grammatical sentences. Ang theory na ito ay nagbigay ng malaking impact hindi lang sa linggwistika kundi pati na rin sa cognitive science, psychology, at philosophy of mind."
        },
        {
          title: "Pananaw nina Edward Sapir at Benjamin Whorf - Linguistic Relativity",
          content: "Ang Sapir-Whorf Hypothesis, na kilala rin bilang linguistic relativity hypothesis, ay isa sa mga pinaka-controversial na teorya sa linggwistika. Ang hypothesis na ito ay binuo ni Edward Sapir (1884-1939) at ng kanyang estudyante na si Benjamin Lee Whorf (1897-1941) batay sa kanilang pag-aaral ng mga indigenous languages ng North America.\n\nAng hypothesis ay may dalawang version: ang weak version (linguistic relativity) at ang strong version (linguistic determinism). Ang weak version ay nagsasabing ang wika ay nakakaimpluwensya sa paraan ng pag-iisip ng mga tao - ang mga salita at konsepto na available sa isang wika ay nakakaapekto sa kung paano nakikita at nauunawaan ng mga nagsasalita ang mundo. Ang strong version naman ay nagsasabing ang wika ay tuluyang nagde-determine ng thought - na hindi natin maiisip ang mga bagay na walang salita sa aming wika.\n\nAng pinakasikat na halimbawa ay ang tungkol sa mga Inuit at sa kanilang maraming salita para sa snow. Ayon kay Whorf, dahil maraming uri ng yelo at niyebe sa kanilang kapaligiran, nag-develop ang mga Inuit ng masaganang vocabulary para dito. Ito raw ay nagbibigay sa kanila ng mas refined na perception ng winter environment kaysa sa mga tao na may limited snow vocabulary.\n\nSa konteksto ng Filipino, makikita natin ang linguistic relativity sa mga salitang walang direktang translation sa Ingles tulad ng 'kilig,' 'gigil,' 'pakikipagkapwa,' at 'bayanihan.' Ang mga salitang ito ay sumasalamin sa mga emotional at social concepts na distinctive sa Filipino culture. Gayundin, ang Filipino ay may mas masaganang vocabulary para sa family relationships (kuya, ate, tito, tita, lola, lolo) kaysa sa Ingles, na nagre-reflect sa importance ng extended family sa Filipino society."
        },
        {
          title: "Mga Modernong Pananaw sa Wika",
          content: "Sa modernong panahon, lumitaw ang mga bagong theoretical approaches sa pag-aaral ng wika na nagdudulot ng mas comprehensive understanding sa nature ng human language. Ang mga modernong pananaw na ito ay nag-integrate ng findings mula sa iba't ibang fields tulad ng cognitive science, neuroscience, computer science, at social psychology.\n\nAng Cognitive Linguistics ay isa sa mga prominent na modernong approach na nag-emphasize sa connection sa pagitan ng wika at cognition. Ang mga cognitive linguists tulad nina George Lakoff at Mark Johnson ay nagtuturo na ang wika ay hindi separate system kundi integrated sa general cognitive abilities ng tao. Ang kanilang research sa metaphor ay nagpapakita kung paano ginagamit natin ang conceptual metaphors sa pang-araw-araw na pakikipag-usap. Halimbawa, ang 'ARGUMENT IS WAR' metaphor ay makikita sa mga expressions tulad ng 'defend your position,' 'attack the argument,' 'shoot down the idea.'\n\nAng Functional Linguistics naman ay nag-focus sa functions ng wika sa social context. Ang mga functional linguists tulad ni Michael Halliday ay interested sa kung paano ginagamit ang wika para sa different purposes - para mag-communicate ng information, para mag-establish ng social relationships, para mag-express ng attitudes, atbp. Ang kanyang Systemic Functional Grammar ay nag-aanalyze ng wika base sa tatlong metafunctions: ideational (content), interpersonal (relationships), at textual (organization).\n\nAng Sociolinguistics at Psycholinguistics ay dalawang interdisciplinary fields na nag-examine ng wika mula sa social at psychological perspectives respectively. Ang sociolinguistics ay nag-aaral ng relationship sa pagitan ng wika at society, habang ang psycholinguistics ay nag-focus sa mental processes involved sa language acquisition, comprehension, at production."
        },
        {
          title: "Kahalagahan ng Iba't ibang Pananaw",
          content: "Ang iba't ibang theoretical perspectives sa wika ay hindi competing theories na dapat pumili ng isa, kundi complementary approaches na nagbibigay ng different insights sa complex phenomenon na tinatawag nating wika. Ang bawat pananaw ay may sariling contributions at limitations na nagiging valuable sa iba't ibang konteksto.\n\nAng structuralist approach ni Saussure ay nagbigay sa atin ng systematic way of analyzing language structure at ng understanding na ang wika ay sistema ng mga interrelated elements. Ito ay naging foundation ng descriptive linguistics at ng mga computational approaches sa language processing. Sa practical applications, ang structuralist principles ay ginagamit sa language teaching, dictionary making, at translation.\n\nAng behaviorist approach ni Bloomfield, kahit na hindi na ganoon ka-influential ngayon, ay nag-contribute sa development ng scientific methods sa linggwistika at sa understanding ng role ng environment sa language learning. Ang mga principles ng behaviorism ay patuloy na ginagamit sa certain aspects ng language pedagogy, lalo na sa pronunciation training at sa formation ng language habits.\n\nAng generative approach ni Chomsky ay nagbigay sa atin ng deeper understanding ng human language capacity at ng mga universal properties ng grammar. Ito ay naging foundation ng theoretical linguistics at ng mga computational models of language. Ang concepts ng competence, performance, at universal grammar ay influential pa rin sa modernong linguistic theory.\n\nAng Sapir-Whorf hypothesis, kahit na controversial, ay nag-highlight ng important relationship sa pagitan ng wika, kultura, at cognition. Ito ay naging inspirasyon ng maraming cross-cultural studies at ay nag-contribute sa development ng cultural linguistics at ng understanding ng linguistic diversity."
        },
        {
          title: "Aplikasyon sa Pag-aaral ng Filipino",
          content: "Ang iba't ibang theoretical perspectives na ito ay may practical applications sa pag-aaral at pagtuturo ng Filipino bilang wika. Ang pag-unawa sa mga different approaches ay tutulong sa mga estudyante, guro, at researchers na mag-develop ng mas comprehensive understanding ng Filipino language.\n\nSa structural analysis, maaari nating gamitin ang principles ni Saussure sa pag-analyze ng phonological at morphological structure ng Filipino. Halimbawa, sa pag-aaral ng mga affixes tulad ng 'mag-,' 'um-,' at 'in-,' makikita natin kung paano ang mga elements na ito ay naging systematic way ng pagbuo ng mga salita. Ang concept ng paradigmatic at syntagmatic relationships ay makakatulong din sa pag-understand ng Filipino syntax.\n\nAng generative approach ni Chomsky ay makakatulong sa pag-understand ng mga complex constructions sa Filipino tulad ng focus system (actor focus, object focus, beneficiary focus, etc.) at ng mga unique features tulad ng 'pseudo-verbs' (malapit, malayo, mayroon). Ang universal grammar principles ay makakatulong ding i-explain kung bakit madaling matuto ng mga Filipino ang ibang languages at vice versa.\n\nAng sociolinguistic approach ay napaka-relevant sa Philippine context dahil sa multilingual nature ng ating society. Ang concepts ng diglossia, code-switching, at language attitudes ay makakatulong sa pag-understand ng current language situation sa Pilipinas - ang roles ng Filipino, English, at mga regional languages sa iba't ibang domains ng society.\n\nAng cognitive linguistic approach ay makakatulong sa pag-understand ng mga uniquely Filipino concepts at metaphors. Ang pag-aaral ng mga cultural keywords tulad ng 'kapamilya,' 'utang na loob,' at 'pakikipagkunware' ay magbibigay ng insights sa Filipino worldview at cultural values."
        }
      ],
      quizQuestions: [
        {
          question: "Sino ang kilala bilang 'Ama ng Modernong Linggwistika' dahil sa kanyang structuralist approach?",
          options: ["Leonard Bloomfield", "Ferdinand de Saussure", "Noam Chomsky", "Edward Sapir"],
          answer: 1,
          difficulty: "easy",
          explanation: "Si Ferdinand de Saussure (1857-1913) ay kilala bilang 'Ama ng Modernong Linggwistika' dahil sa kanyang revolutionary na mga ideya tungkol sa structural linguistics. Ang kanyang concepts ng signifier/signified, langue/parole, at arbitrariness of language ay naging foundation ng modernong linguistic theory."
        },
        {
          question: "Ano ang ibig sabihin ng 'arbitraryo' sa konteksto ni Saussure?",
          options: ["May natural na koneksyon ang tunog at kahulugan", "Walang natural na koneksyon ang tunog at kahulugan", "Lahat ng wika ay pareho", "Ang wika ay hindi importante"],
          answer: 1,
          difficulty: "medium",
          explanation: "Ang 'arbitraryo' ayon kay Saussure ay nangangahulugang walang natural na koneksyon sa pagitan ng signifier (tunog) at signified (kahulugan). Halimbawa, walang natural na dahilan kung bakit ang 'aso' ay tinatawag na 'aso' sa Tagalog - ito ay resulta lang ng cultural convention o kasunduan ng mga nagsasalita."
        },
        {
          question: "Alin sa mga sumusunod ang hindi kabilang sa Language Acquisition Device (LAD) ni Chomsky?",
          options: ["Innate capacity para sa wika", "Universal Grammar", "Behavioral conditioning", "Species-specific na kakayahan"],
          answer: 2,
          difficulty: "medium",
          explanation: "Ang behavioral conditioning ay hindi bahagi ng LAD ni Chomsky. Sa katunayan, ang LAD theory ni Chomsky ay direktang sumusuway sa behaviorist approach na nag-emphasize sa conditioning. Ang LAD ay nagsasabing may innate, biological capacity ang mga tao para sa wika na hindi nakadepende sa external conditioning."
        },
        {
          question: "Sa Sapir-Whorf Hypothesis, ano ang weak version o linguistic relativity?",
          options: ["Ang wika ay completely nagde-determine ng thought", "Ang wika ay nakakaimpluwensya sa paraan ng pag-iisip", "Ang lahat ng wika ay pareho", "Ang wika ay hindi nakakaapekto sa thought"],
          answer: 1,
          difficulty: "medium",
          explanation: "Ang weak version ng Sapir-Whorf Hypothesis, na tinatawag na linguistic relativity, ay nagsasabing ang wika ay nakakaimpluwensya (hindi completely determine) sa paraan ng pag-iisip ng mga tao. Ang mga available na salita at konsepto sa isang wika ay nakakaapekto sa kung paano nakikita ng mga nagsasalita ang mundo, pero hindi naman tuluyang nire-restrict ang kanilang thought processes."
        },
        {
          question: "Ano ang pangunahing pagkakaiba sa pagitan ng 'langue' at 'parole' ayon kay Saussure?",
          options: ["Walang pagkakaiba", "Langue ay abstract system, parole ay actual use", "Langue ay spoken, parole ay written", "Langue ay individual, parole ay social"],
          answer: 1,
          difficulty: "hard",
          explanation: "Ang 'langue' ayon kay Saussure ay tumutukoy sa abstract na sistema ng wika - ang mga shared rules, structures, at conventions na kilala ng lahat ng miyembro ng speech community. Ang 'parole' naman ay tumutukoy sa actual, individual na paggamit ng wika sa specific contexts. Ang langue ay social at systematic, habang ang parole ay personal at situational."
        },
        {
          question: "Alin sa mga sumusunod ang halimbawa ng linguistic relativity sa Filipino?",
          options: ["Ang Filipino ay mahirap matuto", "Ang mga salitang 'kilig' at 'gigil' na walang exact translation", "Ang Filipino ay walang grammar", "Ang Filipino ay galing sa Ingles"],
          answer: 1,
          difficulty: "easy",
          explanation: "Ang mga salitang tulad ng 'kilig,' 'gigil,' 'pakikipagkapwa,' at 'bayanihan' ay mga halimbawa ng linguistic relativity dahil ang mga emotional at cultural concepts na ito ay distinctive sa Filipino culture at walang exact equivalent sa ibang wika. Ito ay nagpapakita kung paano ang wika ay nare-reflect ang unique worldview at experiences ng isang cultural group."
        },
        {
          question: "Ano ang pangunahing criticism kay Bloomfield na naging dahilan ng rise ng generative grammar?",
          options: ["Masyadong scientific ang approach niya", "Hindi niya kinonsider ang mental processes", "Masyadong nag-focus sa written language", "Hindi niya alam ang iba't ibang wika"],
          answer: 1,
          difficulty: "hard",
          explanation: "Ang pangunahing criticism kay Bloomfield ay ang kanyang behaviorist approach na nag-focus lang sa observable behavior at nag-ignore sa mental processes involved sa language. Si Chomsky ay nag-argue na hindi sufficient ang stimulus-response model para i-explain ang creativity at complexity ng human language, at na dapat i-consider ang cognitive aspects ng language acquisition at use."
        },
        {
          question: "Sa modernong cognitive linguistics, ano ang ibig sabihin ng conceptual metaphor?",
          options: ["Mga figurative na salita lang", "Mga systematic ways ng pag-understand ng abstract concepts", "Mga literary devices", "Mga mali na paggamit ng wika"],
          answer: 1,
          difficulty: "hard",
          explanation: "Ang conceptual metaphor ayon kina Lakoff at Johnson ay mga systematic ways ng pag-understand at pag-conceptualize ng abstract ideas gamit ang mas concrete experiences. Hindi ito mere literary devices, kundi fundamental ways kung paano natin ini-organize ang aming thought processes. Halimbawa, ang 'TIME IS MONEY' metaphor ay makikita sa mga expressions tulad ng 'spend time,' 'save time,' 'waste time.'"
        },
        {
          question: "Bakit importante ang pag-aaral ng iba't ibang theoretical perspectives sa wika?",
          options: ["Para makabuo ng perpektong theory", "Para makakuha ng complementary insights", "Para makagawa ng controversy", "Para maging expert sa lahat"],
          answer: 1,
          difficulty: "medium",
          explanation: "Ang iba't ibang theoretical perspectives ay nagbibigay ng complementary insights sa complex phenomenon ng wika. Walang single theory na completely nag-e-explain sa lahat ng aspects ng language. Ang structural approach ay maganda sa analysis ng language systems, ang generative approach ay valuable sa understanding ng universal properties, ang sociolinguistic approach ay important sa social contexts, atbp."
        },
        {
          question: "Sa konteksto ng Filipino, paano nakakatulong ang structural approach sa pag-analyze ng morphology?",
          options: ["Hindi nakakatulong", "Sa pag-identify ng systematic patterns ng affixation", "Sa pag-translate sa English", "Sa pagsulat ng tula"],
          answer: 1,
          difficulty: "medium",
          explanation: "Ang structural approach ay nakakatulong sa pag-analyze ng Filipino morphology sa pamamagitan ng pag-identify ng systematic patterns sa affixation system. Halimbawa, makikita natin ang paradigmatic relationships sa pagitan ng 'mag-,' 'um-,' 'in-,' at 'i-' affixes, at kung paano sila nag-fo-function sa focus system ng Filipino. Ito ay tumutulong sa atin na maintindihan ang underlying structure ng Filipino word formation."
        },
        {
          question: "Ano ang signifier at signified sa salitang 'bahay'?",
          options: ["Signifier: concept ng tahanan, Signified: /b-a-h-a-y/", "Signifier: /b-a-h-a-y/, Signified: concept ng tahanan", "Pareho lang sila", "Walang signifier at signified"],
          answer: 1,
          difficulty: "easy",
          explanation: "Sa salitang 'bahay,' ang signifier ay ang mga tunog /b-a-h-a-y/ o ang written form 'bahay' - ito ang material form ng sign. Ang signified naman ay ang mental concept ng tahanan, tirahan, o structure na ginagamit para sa paninirahan. Ang dalawang ito ay nagko-combine para makabuo ng complete linguistic sign."
        },
        {
          question: "Bakit controversial ang strong version ng Sapir-Whorf Hypothesis?",
          options: ["Dahil masyadong simple", "Dahil nagsasabing ang wika ay completely nagde-determine ng thought", "Dahil walang evidence", "Dahil masyadong popular"],
          answer: 1,
          difficulty: "hard",
          explanation: "Ang strong version ng Sapir-Whorf Hypothesis (linguistic determinism) ay controversial dahil nagsasabi nito na ang wika ay completely nagde-determine ng thought - na hindi natin maiisip ang mga concepts na walang palabras sa aming wika. Ito ay naging controversial dahil maraming counter-evidence na nagpapakita na capable ang mga tao ng abstract thinking kahit na limited ang vocabulary nila sa certain domains."
        },
        {
          question: "Ano ang Universal Grammar ayon kay Chomsky?",
          options: ["Lahat ng wika ay pareho", "May common grammatical principles ang lahat ng human languages", "Dapat mag-universal language", "Ang English ay universal"],
          answer: 1,
          difficulty: "medium",
          explanation: "Ang Universal Grammar ayon kay Chomsky ay hindi nangangahulugang lahat ng wika ay pareho, kundi na may mga fundamental principles ng grammar na shared ng lahat ng human languages. Ito ay mga basic structural properties na makikita sa lahat ng natural human languages, tulad ng may distinction sa pagitan ng nouns at verbs, may paraan ng pagtatanong, may negation, atbp."
        },
        {
          question: "Sa functional linguistics, ano ang tatlong metafunctions ni Halliday?",
          options: ["Phonology, Morphology, Syntax", "Ideational, Interpersonal, Textual", "Speaking, Writing, Reading", "Grammar, Vocabulary, Pronunciation"],
          answer: 1,
          difficulty: "hard",
          explanation: "Ang tatlong metafunctions ni Halliday ay: (1) Ideational - para sa content o representation ng experience; (2) Interpersonal - para sa social relationships at interaction; at (3) Textual - para sa organization ng message as coherent text. Ang mga metafunctions na ito ay simultaneous na present sa lahat ng uses ng language."
        },
        {
          question: "Paano nakakatulong ang cognitive linguistics sa pag-understand ng Filipino culture?",
          options: ["Hindi nakakatulong", "Sa pag-analyze ng cultural keywords at conceptual metaphors", "Sa pagtranslate sa English", "Sa pagcorrect ng grammar"],
          answer: 1,
          difficulty: "medium",
          explanation: "Ang cognitive linguistics ay nakakatulong sa pag-understand ng Filipino culture sa pamamagitan ng pag-analyze ng cultural keywords (tulad ng 'kapamilya,' 'utang na loob,' 'pakikipagkapwa') at ng mga conceptual metaphors na ginagamit sa Filipino. Ang mga linguistic expressions na ito ay sumasalamin sa unique Filipino worldview at cultural values, na hindi madaling ma-translate sa ibang languages."
        }
      ]
    },
    {
      moduleNumber: 2,
      title: "Kahalagahan, Kaligiran at Katangian ng Wika",
      description: "Comprehensive examination of language importance, historical background, and distinctive characteristics",
      category: "Foundation",
      color: "foundation",
      learningObjectives: [
        "Mauunawaan ang iba't ibang kahalagahan ng wika sa individual at social level",
        "Makilala ang historical at cultural background ng wika",
        "Matatandaan ang mga pangunahing katangian ng wika",
        "Maisasabuhay ang mga prinsipyo ng wika sa pang-araw-araw na komunikasyon"
      ],
      studyCards: [
        {
          title: "Kahalagahan ng Wika sa Komunikasyon",
          content: "Ang wika ay ang pinakamahalagang kasangkapan ng tao sa komunikasyon. Ito ang nagbibigay-daan sa pagpapahayag ng mga kaisipan, damdamin, pangangailangan, at intensyon sa kapwa. Hindi lamang simpleng paraan ng paghahatid ng mensahe ang wika, kundi ito rin ang nagsisilbing tulay na nag-uugnay sa mga indibidwal at sa mga komunidad.\n\nSa pang-araw-araw na buhay, ginagamit natin ang wika sa iba't ibang paraan: sa tahanan para makipag-ugnayan sa pamilya, sa paaralan para matuto at magbahagi ng kaalaman, sa trabaho para makipag-coordinate sa mga kasama, at sa lipunan para maging bahagi ng mas malaking komunidad. Ang wika ay nagbibigay sa atin ng kakayahang mag-express ng complex ideas, emotions, at abstract concepts na hindi kayang ipahayag ng mga hayop.\n\nAng efficiency ng wika bilang communication tool ay nakikita sa kanyang flexibility at creativity. Maaari nating gamitin ang wika para mag-describe ng mga bagay na hindi namin nakikita (tulad ng mga pangarap o memorya), para mag-create ng fiction at art, para mag-argue at mag-persuade, at para mag-share ng knowledge across generations. Ang property ng displacement sa wika ay nagbibigay-daan sa atin na mag-talk about past, present, at future events, na nagdudulot ng continuity sa human experience.\n\nSa digital age, ang kahalagahan ng wika sa komunikasyon ay mas naging complex at diverse. Ang social media, texting, at online platforms ay nag-create ng mga bagong forms ng linguistic expression tulad ng emoticons, abbreviations, at internet slang. Ang mga developments na ito ay nagpapakita ng adaptability ng wika sa changing communication needs ng society."
        },
        {
          title: "Wika bilang Tagapag-ingat ng Kultura",
          content: "Ang wika ay hindi lamang tool para sa communication, kundi isa ring repository ng kultura, kasaysayan, at collective wisdom ng isang bayan. Sa pamamagitan ng wika, naipapasa natin ang mga traditional knowledge, values, beliefs, at practices mula sa isang henerasyon patungo sa kasunod na henerasyon.\n\nSa konteksto ng Pilipinas, ang Filipino at ang iba't ibang regional languages ay nagtataglay ng mayayamang cultural content. Ang mga salawikain tulad ng 'Ang hindi marunong lumingon sa pinanggalingan ay hindi makararating sa paroroonan' ay naglalaman ng mga moral at practical wisdom na naging gabay ng mga Pilipino sa loob ng maraming siglo. Ang mga traditional stories, myths, at legends na nasa aming mga wika ay nagpo-preserve ng historical memories at cultural values ng aming mga ninuno.\n\nAng mga ritualistic at ceremonial uses ng wika ay nagpapakita rin ng kanyang role bilang culture keeper. Ang mga religious prayers, traditional songs, at ceremonial speeches ay may special linguistic forms na nag-connect sa amin sa spiritual at cultural heritage. Ang mga specialized vocabularies para sa traditional crafts, agricultural practices, at indigenous knowledge systems ay nagiging repositories ng technical at cultural information na mahirap ma-preserve sa ibang paraan.\n\nKapag nawawala ang isang wika, nawawala rin ang unique cultural perspective at knowledge system na naka-encode doon. Ito ang dahilan kung bakit ang language preservation ay considered na crucial aspect ng cultural conservation. Ang UNESCO ay nag-classify ng maraming indigenous languages sa Pilipinas bilang endangered, na nagpapakita ng urgency ng language documentation at revitalization efforts."
        }
      ],
      quizQuestions: [
        {
          question: "Alin sa mga sumusunod ang hindi kabilang sa mga pangunahing katangian ng wika?",
          options: ["Masistema", "Arbitraryo", "Static na hindi nagbabago", "Buhay at dinamiko"],
          answer: 2,
          difficulty: "easy",
          explanation: "Ang wika ay buhay at dinamiko, hindi static. Ito ay patuloy na nagbabago at umuunlad kasama ng mga nagagamit nito. Ang pagbabago ng wika ay makikita sa evolution ng vocabulary, grammar, pronunciation, at meaning ng mga salita sa paglipas ng panahon."
        },
        {
          question: "Ano ang ibig sabihin ng 'wika ay arbitraryo'?",
          options: ["Walang patakaran ang wika", "Walang natural na koneksyon ang tunog at kahulugan", "Ang wika ay random", "Ang wika ay hindi mahalaga"],
          answer: 1,
          difficulty: "medium",
          explanation: "Ang 'arbitraryo' ay nangangahulugang walang natural o inherent na koneksyon sa pagitan ng mga tunog ng wika at ng mga bagay o konsepto na tinutukoy nila. Ang relationship sa pagitan ng signifier at signified ay resulta ng cultural convention, hindi ng natural law."
        }
      ]
    }
    // Additional modules would continue here...
  ]
};

// Application State
let currentState = {
  currentModule: null,
  currentMode: 'dashboard',
  studyCardIndex: 0,
  quizQuestionIndex: 0,
  quizAnswers: [],
  moduleProgress: {},
  isRandomQuiz: false,
  bookmarkedCards: [],
  cardNotes: {},
  reviewMode: {
    isActive: false,
    mistakes: [],
    currentMistakeIndex: 0
  }
};

// Initialize progress for all modules
appData.modules.forEach(module => {
  currentState.moduleProgress[module.moduleNumber] = {
    studyCompleted: false,
    quizCompleted: false,
    quizScore: 0,
    status: 'not-started',
    progress: 0
  };
});

// DOM Elements
const dashboard = document.getElementById('dashboard');
const studyMode = document.getElementById('studyMode');
const quizMode = document.getElementById('quizMode');
const quizResults = document.getElementById('quizResults');
const reviewMode = document.getElementById('reviewMode');
const modulesGrid = document.getElementById('modulesGrid');

// Initialize Application
document.addEventListener('DOMContentLoaded', function() {
  renderModules();
  updateOverallProgress();
  attachEventListeners();
});

// Event Listeners
function attachEventListeners() {
  // Dashboard buttons
  document.getElementById('studyAllBtn').addEventListener('click', startStudyAll);
  document.getElementById('randomQuizBtn').addEventListener('click', startRandomQuiz);
  
  // Study mode navigation
  document.getElementById('backToModules').addEventListener('click', showDashboard);
  document.getElementById('prevCard').addEventListener('click', previousStudyCard);
  document.getElementById('nextCard').addEventListener('click', nextStudyCard);
  document.getElementById('startQuizFromStudy').addEventListener('click', startQuizFromStudy);
  document.getElementById('prevModuleBtn').addEventListener('click', goToPreviousModule);
  document.getElementById('nextModuleBtn').addEventListener('click', goToNextModule);
  
  // Study card actions
  document.getElementById('bookmarkCard').addEventListener('click', toggleBookmark);
  document.getElementById('takeNotes').addEventListener('click', toggleNotes);
  document.getElementById('saveNotes').addEventListener('click', saveNotes);
  document.getElementById('closeNotes').addEventListener('click', closeNotes);
  
  // Quiz mode navigation - Fixed back button functionality
  document.getElementById('backFromQuiz').addEventListener('click', handleQuizBackNavigation);
  document.getElementById('nextQuestion').addEventListener('click', nextQuizQuestion);
  
  // Results navigation
  document.getElementById('retakeQuiz').addEventListener('click', retakeQuiz);
  document.getElementById('reviewMistakes').addEventListener('click', startReviewMode);
  document.getElementById('backToDashboard').addEventListener('click', showDashboard);
  document.getElementById('prevModuleFromResults').addEventListener('click', goToPreviousModuleFromResults);
  document.getElementById('nextModuleFromResults').addEventListener('click', goToNextModuleFromResults);
  
  // Review mode navigation
  document.getElementById('backFromReview').addEventListener('click', showResults);
  document.getElementById('prevReviewQuestion').addEventListener('click', previousReviewQuestion);
  document.getElementById('nextReviewQuestion').addEventListener('click', nextReviewQuestion);
}

// Fixed back navigation for quiz mode
function handleQuizBackNavigation() {
  if (currentState.isRandomQuiz) {
    showDashboard();
  } else if (currentState.currentModule) {
    // Go back to study mode for the current module
    showStudyMode();
  } else {
    // Fallback to dashboard
    showDashboard();
  }
}

// Render Functions
function renderModules() {
  modulesGrid.innerHTML = '';
  
  appData.modules.forEach(module => {
    const progress = currentState.moduleProgress[module.moduleNumber];
    const moduleCard = createModuleCard(module, progress);
    modulesGrid.appendChild(moduleCard);
  });
}

function createModuleCard(module, progress) {
  const card = document.createElement('div');
  card.className = `module-card module-card--${module.color}`;
  
  if (progress.status === 'completed') {
    card.classList.add('module-card--completed');
  }
  
  const studyCardsCount = module.studyCards ? module.studyCards.length : 8;
  const quizQuestionsCount = module.quizQuestions ? module.quizQuestions.length : 15;
  
  card.innerHTML = `
    <div class="module-header">
      <div>
        <div class="module-number">Module ${module.moduleNumber}</div>
        <h3 class="module-title">${module.title}</h3>
      </div>
      <span class="module-category module-category--${module.color}">
        ${module.category}
      </span>
    </div>
    <p class="module-description">${module.description}</p>
    <div class="module-stats">
      <small>üìö ${studyCardsCount} Study Cards ‚Ä¢ üìù ${quizQuestionsCount} Quiz Questions</small>
    </div>
    <div class="module-progress">
      <div class="progress-indicator">
        <div class="progress-indicator-fill" style="width: ${progress.progress}%"></div>
      </div>
      <span>${progress.progress}% Complete</span>
    </div>
    <div class="module-actions">
      <button class="btn btn--primary study-btn" data-module-number="${module.moduleNumber}">
        üìö Study
      </button>
      <button class="btn btn--secondary quiz-btn" data-module-number="${module.moduleNumber}">
        üìù Quiz
      </button>
    </div>
  `;
  
  // Add event listeners
  card.querySelector('.study-btn').addEventListener('click', () => startStudy(module.moduleNumber));
  card.querySelector('.quiz-btn').addEventListener('click', () => startQuiz(module.moduleNumber));
  
  return card;
}

// Navigation Functions
function showDashboard() {
  hideAllSections();
  dashboard.classList.remove('hidden');
  currentState.currentMode = 'dashboard';
  updateOverallProgress();
  updateDashboardStats();
}

function showStudyMode() {
  hideAllSections();
  studyMode.classList.remove('hidden');
  currentState.currentMode = 'study';
}

function showQuizMode() {
  hideAllSections();
  quizMode.classList.remove('hidden');
  currentState.currentMode = 'quiz';
}

function showResults() {
  hideAllSections();
  quizResults.classList.remove('hidden');
  currentState.currentMode = 'results';
}

function showReviewMode() {
  hideAllSections();
  reviewMode.classList.remove('hidden');
  currentState.currentMode = 'review';
}

function hideAllSections() {
  dashboard.classList.add('hidden');
  studyMode.classList.add('hidden');
  quizMode.classList.add('hidden');
  quizResults.classList.add('hidden');
  reviewMode.classList.add('hidden');
}

// Study Mode Functions
function startStudy(moduleNumber) {
  currentState.currentModule = appData.modules.find(m => m.moduleNumber === moduleNumber);
  currentState.studyCardIndex = 0;
  currentState.isRandomQuiz = false;
  
  setupStudyMode();
  showStudyMode();
}

function startStudyAll() {
  currentState.currentModule = appData.modules[0];
  currentState.studyCardIndex = 0;
  currentState.isRandomQuiz = false;
  
  setupStudyMode();
  showStudyMode();
}

function setupStudyMode() {
  const module = currentState.currentModule;
  document.getElementById('currentModuleBreadcrumb').textContent = `Module ${module.moduleNumber} of ${appData.modules.length}`;
  document.getElementById('studyModuleTitle').textContent = `Module ${module.moduleNumber}: ${module.title}`;
  document.getElementById('studyModuleDescription').textContent = module.description;
  
  // Render learning objectives
  const objectivesList = document.getElementById('objectivesList');
  objectivesList.innerHTML = '';
  module.learningObjectives.forEach(objective => {
    const li = document.createElement('li');
    li.textContent = objective;
    objectivesList.appendChild(li);
  });
  
  renderStudyCard();
  updateStudyProgress();
  updateModuleNavigationButtons();
  generateCardDots();
}

function renderStudyCard() {
  const module = currentState.currentModule;
  const cardIndex = currentState.studyCardIndex;
  const studyCards = module.studyCards || [];
  
  if (cardIndex < studyCards.length) {
    const card = studyCards[cardIndex];
    document.getElementById('studyCardTitle').textContent = card.title;
    document.getElementById('studyCardContent').innerHTML = card.content.replace(/\n\n/g, '</p><p>').replace(/^/, '<p>').replace(/$/, '</p>');
  }
  
  document.getElementById('cardCounter').textContent = `${cardIndex + 1} / ${studyCards.length}`;
  
  // Update navigation buttons
  document.getElementById('prevCard').disabled = cardIndex === 0;
  document.getElementById('nextCard').disabled = cardIndex === studyCards.length - 1;
  
  // Update card dots
  updateCardDots();
  
  // Update bookmark button
  const cardId = `${module.moduleNumber}-${cardIndex}`;
  const bookmarkBtn = document.getElementById('bookmarkCard');
  bookmarkBtn.textContent = currentState.bookmarkedCards.includes(cardId) ? 'üîñ Bookmarked' : 'üîñ Bookmark';
  
  // Load existing notes
  loadCardNotes();
}

function generateCardDots() {
  const module = currentState.currentModule;
  const dotsContainer = document.getElementById('cardDots');
  dotsContainer.innerHTML = '';
  
  const studyCards = module.studyCards || [];
  studyCards.forEach((_, index) => {
    const dot = document.createElement('div');
    dot.className = 'dot';
    if (index === currentState.studyCardIndex) {
      dot.classList.add('active');
    }
    dot.addEventListener('click', () => goToCard(index));
    dotsContainer.appendChild(dot);
  });
}

function updateCardDots() {
  const dots = document.querySelectorAll('.dot');
  dots.forEach((dot, index) => {
    dot.classList.toggle('active', index === currentState.studyCardIndex);
  });
}

function goToCard(cardIndex) {
  currentState.studyCardIndex = cardIndex;
  renderStudyCard();
}

function previousStudyCard() {
  if (currentState.studyCardIndex > 0) {
    currentState.studyCardIndex--;
    renderStudyCard();
  }
}

function nextStudyCard() {
  const module = currentState.currentModule;
  const studyCards = module.studyCards || [];
  
  if (currentState.studyCardIndex < studyCards.length - 1) {
    currentState.studyCardIndex++;
    renderStudyCard();
  } else {
    // Mark study as completed
    const progress = currentState.moduleProgress[module.moduleNumber];
    progress.studyCompleted = true;
    updateModuleStatus(module.moduleNumber);
    renderModules();
  }
}

// Bookmark Functions
function toggleBookmark() {
  const module = currentState.currentModule;
  const cardId = `${module.moduleNumber}-${currentState.studyCardIndex}`;
  
  if (currentState.bookmarkedCards.includes(cardId)) {
    currentState.bookmarkedCards = currentState.bookmarkedCards.filter(id => id !== cardId);
  } else {
    currentState.bookmarkedCards.push(cardId);
  }
  
  renderStudyCard();
}

// Notes Functions
function toggleNotes() {
  const notesSection = document.getElementById('notesSection');
  notesSection.classList.toggle('hidden');
}

function loadCardNotes() {
  const module = currentState.currentModule;
  const cardId = `${module.moduleNumber}-${currentState.studyCardIndex}`;
  const notes = currentState.cardNotes[cardId] || '';
  document.getElementById('cardNotes').value = notes;
}

function saveNotes() {
  const module = currentState.currentModule;
  const cardId = `${module.moduleNumber}-${currentState.studyCardIndex}`;
  const notes = document.getElementById('cardNotes').value;
  currentState.cardNotes[cardId] = notes;
  
  // Show confirmation
  const saveBtn = document.getElementById('saveNotes');
  const originalText = saveBtn.textContent;
  saveBtn.textContent = '‚úì Saved!';
  setTimeout(() => {
    saveBtn.textContent = originalText;
  }, 2000);
}

function closeNotes() {
  document.getElementById('notesSection').classList.add('hidden');
}

function goToPreviousModule() {
  const currentModuleNumber = currentState.currentModule.moduleNumber;
  if (currentModuleNumber > 1) {
    startStudy(currentModuleNumber - 1);
  }
}

function goToNextModule() {
  const currentModuleNumber = currentState.currentModule.moduleNumber;
  if (currentModuleNumber < appData.modules.length) {
    startStudy(currentModuleNumber + 1);
  }
}

function updateModuleNavigationButtons() {
  const currentModuleNumber = currentState.currentModule.moduleNumber;
  document.getElementById('prevModuleBtn').disabled = currentModuleNumber === 1;
  document.getElementById('nextModuleBtn').disabled = currentModuleNumber === appData.modules.length;
}

function updateStudyProgress() {
  const module = currentState.currentModule;
  const studyCards = module.studyCards || [];
  
  document.getElementById('cardCounter').textContent = `${currentState.studyCardIndex + 1} / ${studyCards.length}`;
}

function startQuizFromStudy() {
  startQuiz(currentState.currentModule.moduleNumber);
}

// Quiz Mode Functions
function startQuiz(moduleNumber) {
  currentState.currentModule = appData.modules.find(m => m.moduleNumber === moduleNumber);
  currentState.quizQuestionIndex = 0;
  currentState.quizAnswers = [];
  currentState.isRandomQuiz = false;
  
  setupQuizMode();
  showQuizMode();
}

function startRandomQuiz() {
  currentState.currentModule = null;
  currentState.quizQuestionIndex = 0;
  currentState.quizAnswers = [];
  currentState.isRandomQuiz = true;
  
  setupRandomQuizMode();
  showQuizMode();
}

function setupQuizMode() {
  const module = currentState.currentModule;
  document.getElementById('quizModuleBreadcrumb').textContent = `Module ${module.moduleNumber} of ${appData.modules.length}`;
  document.getElementById('quizModuleTitle').textContent = `Module ${module.moduleNumber}: ${module.title}`;
  
  renderQuizQuestion();
  updateQuizProgress();
}

function setupRandomQuizMode() {
  currentState.currentModule = null; // Ensure it's null for random quiz
  document.getElementById('quizModuleBreadcrumb').textContent = 'Mixed Quiz';
  document.getElementById('quizModuleTitle').textContent = 'All Modules Quiz';
  
  renderQuizQuestion();
  updateQuizProgress();
}

function getQuizQuestions() {
  if (currentState.isRandomQuiz) {
    // Get all questions from all modules and shuffle
    const allQuestions = [];
    appData.modules.forEach(module => {
      if (module.quizQuestions) {
        allQuestions.push(...module.quizQuestions);
      }
    });
    return allQuestions.sort(() => Math.random() - 0.5);
  } else {
    // Return questions for current module
    return currentState.currentModule.quizQuestions || [];
  }
}

function renderQuizQuestion() {
  const questions = getQuizQuestions();
  const questionIndex = currentState.quizQuestionIndex;
  
  if (questionIndex >= questions.length) {
    calculateAndShowResults();
    return;
  }
  
  const question = questions[questionIndex];
  
  // Show difficulty
  const difficultyElement = document.getElementById('questionDifficulty');
  difficultyElement.textContent = question.difficulty || 'Medium';
  difficultyElement.className = `question-difficulty ${question.difficulty || 'medium'}`;
  
  document.getElementById('questionText').textContent = question.question;
  document.getElementById('questionCounter').textContent = `${questionIndex + 1} / ${questions.length}`;
  
  // Render options
  const optionsContainer = document.getElementById('optionsContainer');
  optionsContainer.innerHTML = '';
  
  question.options.forEach((option, index) => {
    const optionBtn = document.createElement('button');
    optionBtn.className = 'option-btn';
    optionBtn.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
    optionBtn.addEventListener('click', () => selectAnswer(index));
    optionsContainer.appendChild(optionBtn);
  });
  
  // Hide feedback
  document.getElementById('quizFeedback').classList.add('hidden');
  document.getElementById('questionCard').classList.remove('hidden');
}

function selectAnswer(selectedIndex) {
  const questions = getQuizQuestions();
  const question = questions[currentState.quizQuestionIndex];
  const isCorrect = selectedIndex === question.answer;
  
  // Store answer
  currentState.quizAnswers.push({
    questionIndex: currentState.quizQuestionIndex,
    question: question.question,
    selectedAnswer: selectedIndex,
    correctAnswer: question.answer,
    isCorrect: isCorrect,
    difficulty: question.difficulty || 'medium',
    explanation: question.explanation
  });
  
  // Show feedback
  showQuizFeedback(isCorrect, question.explanation);
  
  // Update option styles
  const options = document.querySelectorAll('.option-btn');
  options.forEach((btn, index) => {
    if (index === selectedIndex) {
      btn.classList.add('selected');
    }
    if (index === question.answer) {
      btn.classList.add('correct');
    } else if (index === selectedIndex && !isCorrect) {
      btn.classList.add('incorrect');
    }
    btn.disabled = true;
  });
}

function showQuizFeedback(isCorrect, explanation) {
  const feedback = document.getElementById('quizFeedback');
  const feedbackIcon = document.getElementById('feedbackIcon');
  const feedbackText = document.getElementById('feedbackText');
  const feedbackExplanation = document.getElementById('feedbackExplanation');
  
  feedbackIcon.textContent = isCorrect ? '‚úÖ' : '‚ùå';
  feedbackText.textContent = isCorrect ? 'Correct!' : 'Incorrect!';
  feedbackText.className = `feedback-text ${isCorrect ? 'correct' : 'incorrect'}`;
  feedbackExplanation.textContent = explanation;
  
  document.getElementById('questionCard').classList.add('hidden');
  feedback.classList.remove('hidden');
}

function nextQuizQuestion() {
  currentState.quizQuestionIndex++;
  
  const questions = getQuizQuestions();
  if (currentState.quizQuestionIndex >= questions.length) {
    calculateAndShowResults();
  } else {
    renderQuizQuestion();
    updateQuizProgress();
  }
}

function updateQuizProgress() {
  const questions = getQuizQuestions();
  const progress = ((currentState.quizQuestionIndex + 1) / questions.length) * 100;
  
  document.getElementById('quizProgressFill').style.width = `${progress}%`;
  document.getElementById('questionCounter').textContent = `${currentState.quizQuestionIndex + 1} / ${questions.length}`;
}

function calculateAndShowResults() {
  const correctAnswers = currentState.quizAnswers.filter(a => a.isCorrect).length;
  const totalQuestions = currentState.quizAnswers.length;
  const percentage = Math.round((correctAnswers / totalQuestions) * 100);
  
  // Calculate grade
  let grade = 'F';
  if (percentage >= 90) grade = 'A';
  else if (percentage >= 80) grade = 'B';
  else if (percentage >= 70) grade = 'C';
  else if (percentage >= 60) grade = 'D';
  
  // Update progress if not random quiz
  if (!currentState.isRandomQuiz && currentState.currentModule) {
    const progress = currentState.moduleProgress[currentState.currentModule.moduleNumber];
    progress.quizCompleted = true;
    progress.quizScore = percentage;
    updateModuleStatus(currentState.currentModule.moduleNumber);
    
    // Show module complete badge if both study and quiz are completed
    if (progress.studyCompleted && progress.quizCompleted) {
      document.getElementById('moduleCompleteBadge').classList.remove('hidden');
    }
    
    updateResultsModuleNavigation();
  }
  
  // Display results
  document.getElementById('finalScore').textContent = `${percentage}%`;
  document.getElementById('scoreGrade').textContent = `Grade: ${grade}`;
  document.getElementById('correctAnswers').textContent = correctAnswers;
  document.getElementById('incorrectAnswers').textContent = totalQuestions - correctAnswers;
  document.getElementById('totalQuestions').textContent = totalQuestions;
  
  let summaryText = `You got ${correctAnswers} out of ${totalQuestions} questions correct.`;
  if (percentage >= 90) {
    summaryText += ' Outstanding performance! üéâ';
  } else if (percentage >= 80) {
    summaryText += ' Excellent work! üëè';
  } else if (percentage >= 70) {
    summaryText += ' Good job! Keep practicing! üìö';
  } else if (percentage >= 60) {
    summaryText += ' Fair performance. Review the material and try again. üí™';
  } else {
    summaryText += ' More study needed. Don\'t give up! üåü';
  }
  
  document.getElementById('resultsSummary').textContent = summaryText;
  
  // Generate performance analysis
  generatePerformanceAnalysis();
  
  renderModules();
  showResults();
}

function generatePerformanceAnalysis() {
  const difficultyBreakdown = document.getElementById('difficultyBreakdown');
  difficultyBreakdown.innerHTML = '';
  
  const difficulties = ['easy', 'medium', 'hard'];
  difficulties.forEach(difficulty => {
    const questionsOfDifficulty = currentState.quizAnswers.filter(a => a.difficulty === difficulty);
    if (questionsOfDifficulty.length > 0) {
      const correct = questionsOfDifficulty.filter(a => a.isCorrect).length;
      const total = questionsOfDifficulty.length;
      const percentage = Math.round((correct / total) * 100);
      
      const statDiv = document.createElement('div');
      statDiv.className = 'difficulty-stat';
      statDiv.innerHTML = `
        <div class="difficulty-label">
          <span class="difficulty-badge ${difficulty}">${difficulty.charAt(0).toUpperCase() + difficulty.slice(1)}</span>
          Questions
        </div>
        <span>${correct}/${total} (${percentage}%)</span>
      `;
      difficultyBreakdown.appendChild(statDiv);
    }
  });
}

function updateResultsModuleNavigation() {
  if (currentState.currentModule) {
    const currentModuleNumber = currentState.currentModule.moduleNumber;
    document.getElementById('prevModuleFromResults').disabled = currentModuleNumber === 1;
    document.getElementById('nextModuleFromResults').disabled = currentModuleNumber === appData.modules.length;
  }
}

function goToPreviousModuleFromResults() {
  if (currentState.currentModule) {
    const currentModuleNumber = currentState.currentModule.moduleNumber;
    if (currentModuleNumber > 1) {
      startQuiz(currentModuleNumber - 1);
    }
  }
}

function goToNextModuleFromResults() {
  if (currentState.currentModule) {
    const currentModuleNumber = currentState.currentModule.moduleNumber;
    if (currentModuleNumber < appData.modules.length) {
      startQuiz(currentModuleNumber + 1);
    }
  }
}

function retakeQuiz() {
  if (currentState.isRandomQuiz) {
    startRandomQuiz();
  } else if (currentState.currentModule) {
    startQuiz(currentState.currentModule.moduleNumber);
  }
}

// Review Mode Functions
function startReviewMode() {
  const mistakes = currentState.quizAnswers.filter(a => !a.isCorrect);
  
  if (mistakes.length === 0) {
    alert('Congratulations! You got all questions correct. No mistakes to review.');
    return;
  }
  
  currentState.reviewMode.mistakes = mistakes;
  currentState.reviewMode.currentMistakeIndex = 0;
  currentState.reviewMode.isActive = true;
  
  renderReviewQuestion();
  showReviewMode();
}

function renderReviewQuestion() {
  const mistakes = currentState.reviewMode.mistakes;
  const currentIndex = currentState.reviewMode.currentMistakeIndex;
  
  if (currentIndex >= mistakes.length) {
    showResults();
    return;
  }
  
  const mistake = mistakes[currentIndex];
  const reviewContainer = document.getElementById('reviewQuestion');
  
  reviewContainer.innerHTML = `
    <div class="review-content">
      <div class="question-difficulty ${mistake.difficulty}">${mistake.difficulty}</div>
      <h3>${mistake.question}</h3>
      <div class="review-explanation">
        <h4>‚ùå Your Answer:</h4>
        <p>Option ${String.fromCharCode(65 + mistake.selectedAnswer)}</p>
        
        <h4>‚úÖ Correct Answer:</h4>
        <p>Option ${String.fromCharCode(65 + mistake.correctAnswer)}</p>
        
        <h4>üìñ Explanation:</h4>
        <p>${mistake.explanation}</p>
      </div>
    </div>
  `;
  
  document.getElementById('reviewCounter').textContent = `${currentIndex + 1} / ${mistakes.length}`;
  
  // Update navigation
  document.getElementById('prevReviewQuestion').disabled = currentIndex === 0;
  document.getElementById('nextReviewQuestion').disabled = currentIndex === mistakes.length - 1;
}

function previousReviewQuestion() {
  if (currentState.reviewMode.currentMistakeIndex > 0) {
    currentState.reviewMode.currentMistakeIndex--;
    renderReviewQuestion();
  }
}

function nextReviewQuestion() {
  const mistakes = currentState.reviewMode.mistakes;
  if (currentState.reviewMode.currentMistakeIndex < mistakes.length - 1) {
    currentState.reviewMode.currentMistakeIndex++;
    renderReviewQuestion();
  }
}

// Progress Functions
function updateModuleStatus(moduleNumber) {
  const progress = currentState.moduleProgress[moduleNumber];
  
  if (progress.studyCompleted && progress.quizCompleted) {
    progress.status = 'completed';
    progress.progress = 100;
  } else if (progress.studyCompleted || progress.quizCompleted) {
    progress.status = 'in-progress';
    progress.progress = progress.studyCompleted ? 50 : 25;
  } else {
    progress.status = 'not-started';
    progress.progress = 0;
  }
}

function updateOverallProgress() {
  const totalModules = appData.modules.length;
  const completedModules = Object.values(currentState.moduleProgress)
    .filter(p => p.status === 'completed').length;
  
  document.querySelector('.progress-text').textContent = `${completedModules}/${totalModules}`;
  
  // Update progress circle
  const circle = document.querySelector('.progress-circle');
  const degrees = (completedModules / totalModules) * 360;
  circle.style.background = `conic-gradient(var(--color-filipino-blue) ${degrees}deg, var(--color-border) ${degrees}deg)`;
}

function updateDashboardStats() {
  const totalModules = appData.modules.length;
  const completedModules = Object.values(currentState.moduleProgress)
    .filter(p => p.status === 'completed').length;
  const inProgressModules = Object.values(currentState.moduleProgress)
    .filter(p => p.status === 'in-progress').length;
  
  document.getElementById('completedModules').textContent = completedModules;
  document.getElementById('inProgressModules').textContent = inProgressModules;
  
  // Calculate total study cards and quiz questions
  let totalStudyCards = 0;
  let totalQuizQuestions = 0;
  appData.modules.forEach(module => {
    totalStudyCards += module.studyCards ? module.studyCards.length : 8;
    totalQuizQuestions += module.quizQuestions ? module.quizQuestions.length : 15;
  });
  
  document.getElementById('totalStudyCards').textContent = totalStudyCards;
  document.getElementById('totalQuizQuestions').textContent = totalQuizQuestions;
}